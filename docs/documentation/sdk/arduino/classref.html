<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-documentation/sdk/arduino/classref">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<title data-rh="true">Class Reference | SimpleIOT</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://awslabs.github.io/simpleiot-build/docs/documentation/sdk/arduino/classref"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Class Reference | SimpleIOT"><meta data-rh="true" name="description" content="To communicate with the SimpleIOT back-end, you can install and use the SimpleIOT Client SDK. The full source for the SDK can be found on Github."><meta data-rh="true" property="og:description" content="To communicate with the SimpleIOT back-end, you can install and use the SimpleIOT Client SDK. The full source for the SDK can be found on Github."><link data-rh="true" rel="icon" href="/simpleiot-build/img/favicon.png"><link data-rh="true" rel="canonical" href="https://awslabs.github.io/simpleiot-build/docs/documentation/sdk/arduino/classref"><link data-rh="true" rel="alternate" href="https://awslabs.github.io/simpleiot-build/docs/documentation/sdk/arduino/classref" hreflang="en"><link data-rh="true" rel="alternate" href="https://awslabs.github.io/simpleiot-build/docs/documentation/sdk/arduino/classref" hreflang="x-default"><link rel="stylesheet" href="/simpleiot-build/assets/css/styles.d802a82b.css">
<link rel="preload" href="/simpleiot-build/assets/js/runtime~main.b3b197bd.js" as="script">
<link rel="preload" href="/simpleiot-build/assets/js/main.cbdba4a3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#18191B;color:#9969F7" role="banner"><div class="announcementBarContent_xLdY">Welcome Starter Bundle users! <a href="/simpleiot-build/docs/workshops/intro">Click here</a> to go to the Workshop.</div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/simpleiot-build/"><div class="navbar__logo"><img src="/simpleiot-build/img/logo.png" alt="SimpleIOT logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/simpleiot-build/img/logo.png" alt="SimpleIOT logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SimpleIOT</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/simpleiot-build/docs/intro">Get Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/simpleiot-build/docs/documentation/intro">Documentation</a><a class="navbar__item navbar__link" href="/simpleiot-build/docs/workshops">Workshops</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/simpleiot-build/docs/team">Team</a><a href="https://github.com/awslabs/simpleiot" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/simpleiot-build/docs/intro">Welcome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/simpleiot-build/docs/concepts">Basic Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/simpleiot-build/docs/install/intro">Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/simpleiot-build/docs/workshops/intro">Workshops</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/simpleiot-build/docs/documentation/intro">Documentation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/simpleiot-build/docs/documentation/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/simpleiot-build/docs/documentation/cli/intro">CLI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/simpleiot-build/docs/documentation/sdk/intro">Client SDKs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/simpleiot-build/docs/documentation/sdk/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/simpleiot-build/docs/documentation/sdk/arduino/intro">Arduino</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/simpleiot-build/docs/documentation/sdk/arduino/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/simpleiot-build/docs/documentation/sdk/arduino/classref">Class Reference</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/simpleiot-build/docs/documentation/data/intro">Data</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/simpleiot-build/docs/contributing">Contributing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/simpleiot-build/docs/legal">Legal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/simpleiot-build/docs/roadmap">Roadmap</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/simpleiot-build/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Documentation</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Client SDKs</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Arduino</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Class Reference</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Introduction</h1><p>To communicate with the SimpleIOT back-end, you can install and use the SimpleIOT Client SDK. The full source for the SDK can be <a href="https://github.com/awslabs/simpleiot-arduino" target="_blank" rel="noopener noreferrer">found on Github</a>.</p><p>To install and use, you can search for <code>simpleiot</code> in the Arduino Library Manager.</p><p>Once installed, you will need to include the header in your Sketch:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;SimpleIOT.h&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You will then need to:</p><ul><li>Create a global instance of the <code>SimpleIOT</code> object.</li><li>Initialize and configure it in the <code>setup()</code> function.</li><li>Obtain data and send it to the cloud using the <code>iot-&gt;set()</code> function.</li><li>Periodically call the <code>iot-&gt;loop()</code> function to give the SDK some time to do work.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="enums">Enums<a class="hash-link" href="#enums" title="Direct link to heading">​</a></h2><p>This section covers the <code>enum</code> values defined in the SDK.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simpleiotmessagetype">SimpleIOTMessageType<a class="hash-link" href="#simpleiotmessagetype" title="Direct link to heading">​</a></h3><p>This enum defines the types of message being sent to the system. These may be:</p><ul><li><strong>MESSAGE_APP</strong>: Application-level messages</li><li><strong>MESSAGE_ADM</strong>: Administrative messages</li><li><strong>MESSAGE_SYS</strong>: Internal system messages</li></ul><p>The private <code>_sendMessage</code> function takes one of these. It defaults to <code>MESSAGE_APP</code>. User-level applications would not need to use any of these.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simpleiotupdatetype">SimpleIOTUpdateType<a class="hash-link" href="#simpleiotupdatetype" title="Direct link to heading">​</a></h3><p><em>Reserved</em>: Parameters that may be received from the cloud when an OTA update is received.</p><p>These may be:</p><ul><li><strong>UPDATE_FIRMWARE</strong>: Firmware binaries.</li><li><strong>UPDATE_CONFIG</strong>: Configuration data.</li><li><strong>UPDATE_FILE</strong>: Fixed assets or files.</li><li><strong>UPDATE_TEST</strong>: Test/diagnostic payloads.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simpleiottype">SimpleIOTType<a class="hash-link" href="#simpleiottype" title="Direct link to heading">​</a></h3><p>Type hints (if defined in the Model) are passed when data is received from the cloud. Values may be:</p><ul><li><strong>IOT_INT</strong>: Integer</li><li><strong>IOT_FLOAT</strong>: Float</li><li><strong>IOT_DOUBLE</strong>: Double</li><li><strong>IOT_STRING</strong>: String</li><li><strong>IOT_BOOLEAN</strong>: Boolean</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="callback-handlers">Callback Handlers<a class="hash-link" href="#callback-handlers" title="Direct link to heading">​</a></h2><p>The following signatures are for callback handlers. You can name these functions anything you want, as long as they comply with the parameter formats. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simpleiotreadycallback">SimpleIOTReadyCallback<a class="hash-link" href="#simpleiotreadycallback" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">typedef void (*SimpleIOTReadyCallback)(SimpleIOT *iot,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    int status,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    String message);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This function is called once all connection setup actions have been completed. The process of establishing a secure connection involves:</p><ul><li>Connecting to WiFi using the provided wifi credentials.</li><li>Establishing a secure TLS connection with the server.</li><li>Opening an MQTT connection to the right AWS IOT endpoint.</li><li>Obtaining confirmation that the connection is active.</li></ul><p>If any of these steps fail, the connection will not be established.</p><p>These operations are performed asynchronously. It is recommended that no data be sent to the cloud until this callback has been called successfully.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parameters">Parameters<a class="hash-link" href="#parameters" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Definition</th></tr></thead><tbody><tr><td><code>iot</code></td><td><code>SimpleIOT*</code></td><td>Instance of SimpleIOT object</td></tr><tr><td><code>status</code></td><td><code>int</code></td><td>Status code. If successful = 0</td></tr><tr><td><code>message</code></td><td><code>String</code></td><td>Error string message</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">void onConnectionReady(SimpleIOT *iot, int status, String message)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.print(&quot;SimpleIOT: &quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.print(message);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SimpleIOT* iot = NULL; // global singleton</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void setup() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /* </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   * Initialize and configure a SimpleIOT instance.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  iot = SimpleIOT::create(WIFI_SSID, WIFI_PASSWORD, SIMPLEIOT_IOT_ENDPOINT, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          SIMPLE_IOT_ROOT_CA, SIMPLE_IOT_DEVICE_CERT, SIMPLE_IOT_DEVICE_PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                     </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  iot-&gt;config(IOT_PROJECT, IOT_MODEL, IOT_SERIAL, IOT_FW_VERSION, onConnectionReady, onDataFromCloud);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Serial.println(&quot;Config started&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simpleiotdatacallback">SimpleIOTDataCallback<a class="hash-link" href="#simpleiotdatacallback" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">typedef void (*SimpleIOTDataCallback)(SimpleIOT *iot,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    String name,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    String value,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    SimpleIOTType type);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This callback is invoked (if provided) when data is received from the cloud. The message payload is parsed, and the callback is invoked, passing the data to be handled inside the application. All data is in the form of name/value pairs.</p><p>Only <code>name</code> values specified in the <em>Model</em> definition are passed back.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-1">Parameters<a class="hash-link" href="#parameters-1" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Definition</th></tr></thead><tbody><tr><td><code>iot</code></td><td><code>SimpleIOT*</code></td><td>Instance of SimpleIOT object</td></tr><tr><td><code>name</code></td><td><code>String</code></td><td>Name of Datatype</td></tr><tr><td><code>value</code></td><td><code>String</code></td><td>Value of data</td></tr><tr><td><code>type</code></td><td><a href="#simpleiottype">SimpleIOTType</a></td><td>Type hint (if defined on Model definition). Can be used to convert the string to the desired type</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1">Example<a class="hash-link" href="#example-1" title="Direct link to heading">​</a></h4><p>Declaration as a global C function in the sketch:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">void onDataFromCloud(SimpleIOT *iot, String name, String value, SimpleIOTType type) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Pass to <code>config</code> at runtime:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  iot-&gt;config(IOT_PROJECT, IOT_MODEL, IOT_SERIAL, IOT_FW_VERSION, onConnectionReady, onDataFromCloud);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>At runtime:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">void onDataFromCloud(SimpleIOT *iot, String name, String value, SimpleIOTType type)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  if (name.equalsIgnoreCase(&quot;color&quot;)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (value.equalsIgnoreCase(&quot;red&quot;)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      setCurrentColor(PLANET_RED);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Using the CLI to send data from the cloud to a specific device:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&gt; iot data set --team=MyTeam --project=HelloProject --serial=HW-0001 --name=color --value=red</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simpleiottriggerupdatecallback">SimpleIOTTriggerUpdateCallback<a class="hash-link" href="#simpleiottriggerupdatecallback" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">typedef void (*SimpleIOTTriggerUpdateCallback)(SimpleIOT *iot,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    String version,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    String downloadUrl,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    SimpleIOTUpdateType updateType);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When an update request is received, this function is called with the version, URL, or payload and an optional update type.</p><p>The caller is expected to match the version number against the current firmware version and then request a download of the actual update from the provided URL via the <a href="#performota">performOTA</a> call.</p><p>For processors other than ESP32, downloading the payload and application of the update will need to be managed manually.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-2">Parameters<a class="hash-link" href="#parameters-2" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Definition</th></tr></thead><tbody><tr><td><code>iot</code></td><td><code>SimpleIOT*</code></td><td>Instance of SimpleIOT object</td></tr><tr><td><code>version</code></td><td><code>String</code></td><td>New update version, in <a href="https://semver.org/" target="_blank" rel="noopener noreferrer">SemVer</a> format.</td></tr><tr><td><code>downloadUrl</code></td><td><code>String</code></td><td>URL of update. Can be passed to <code>performOTA</code> function or downloaded manually</td></tr><tr><td><code>updateType</code></td><td><a href="#simpleiotupdatetype">SimpleIOTUpdateType</a></td><td>Optional update type. It could be firmware, configuration data, files, or test/diagnostics payloads.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simpleiototacallback">SimpleIOTOTACallback<a class="hash-link" href="#simpleiototacallback" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">typedef void (*SimpleIOTOTACallback)(int currentDownload,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    int totalDownload,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    int percent);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This callback is invoked if passed to the <a href="#performota">performOTA</a> method. It will be called with periodic updates so a user interface can be updated.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-3">Parameters<a class="hash-link" href="#parameters-3" title="Direct link to heading">​</a></h4><table><thead><tr><th align="left">Name</th><th>Type</th><th>Definition</th></tr></thead><tbody><tr><td align="left"><code>currentDownload</code></td><td><code>int</code></td><td>Number of bytes downloaded</td></tr><tr><td align="left"><code>totalDownload</code></td><td><code>int</code></td><td>Total size of download</td></tr><tr><td align="left"><code>percent</code></td><td><code>int</code></td><td>Download percent complete</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simpleiotdiagcallback">SimpleIOTDiagCallback<a class="hash-link" href="#simpleiotdiagcallback" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">typedef const char* (*SimpleIOTDiagCallback)(SimpleIOT *iot,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    String diagId,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    String data,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    SimpleIOTDiagType diagType);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This callback is invoked when a remote diagnostic is initiated from the cloud. This is a placeholder for upcoming remote diagnostics.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-4">Parameters<a class="hash-link" href="#parameters-4" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Definition</th></tr></thead><tbody><tr><td><code>iot</code></td><td><code>SimpleIOT*</code></td><td>Instance of SimpleIOT object</td></tr><tr><td><code>diagId</code></td><td><code>String</code></td><td>Name of Diagnostic</td></tr><tr><td><code>data</code></td><td><code>String</code></td><td>Data to be passed to Diagnostic test</td></tr><tr><td><code>diagType</code></td><td><a href="#simpleiotdiagtype">SimpleIOTDiagType</a></td><td>Type of diagnostic</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="methods">Methods<a class="hash-link" href="#methods" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create">create<a class="hash-link" href="#create" title="Direct link to heading">​</a></h3><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>The default constructor <code>SimpleIOT()</code> could not be used to create an instance. Instead, the <code>create</code> static method should be used since it creates a singleton instance.</p></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">static SimpleIOT* create(const char* wifiSSID,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                         const char* wifiPassword,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                         const char* iotEndpoint,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                         const char* caPem,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                         const char* certPem,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                         const char* keyPem,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                         bool withGateway=false);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This class static method is used to create a singleton instance of the <code>SimpleIOT</code> object. Use this to create the instance. The <code>init</code> method could then be used to initialize and pass project settings.</p><p>The data to be passed here are considered static to an application. They include values like the IOT endpoint, wifi settings, and security credentials.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-5">Parameters<a class="hash-link" href="#parameters-5" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Definition</th></tr></thead><tbody><tr><td><code>wifiSSID</code></td><td><code>String*</code></td><td>WiFi router SSID name</td></tr><tr><td><code>wifiPassword</code></td><td><code>String</code></td><td>WiFi router password</td></tr><tr><td><code>iotEndpoint</code></td><td><code>String</code></td><td>URL of AWS IoT endpoint</td></tr><tr><td><code>caPem</code></td><td><code>String</code></td><td>Certificate Authority text in PEM format</td></tr><tr><td><code>certPem</code></td><td><code>String</code></td><td>Device Certificate text in PEM format</td></tr><tr><td><code>keyPem</code></td><td><code>String</code></td><td>Device Private Key text in PEM format</td></tr><tr><td><code>withGateway</code></td><td><code>bool</code></td><td>false: standalone device. true: Connect via GGv2 gateway</td></tr></tbody></table><p>The <code>wifiSSID</code> and <code>wifiPassword</code> parameters are string values for the WiFi router the device should connect to get access to the cloud.</p><p>There are multiple ways to obtain and store WiFi credentials. This document on <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/provisioning/wifi_provisioning.html" target="_blank" rel="noopener noreferrer">WiFi Provisioning</a> provides several methods defined by the ESP32 processor. The mechanism will be different for each manufacturer.</p><p>For development, embedding WiFi passwords is the easiest method to be up and running quickly. For production systems, however, the on-boarding/provisioning and credential caching flows should be carefully designed. </p><p>When installed, the <code>iotEndpoint</code> URL is generated by the SimpleIOT back-end. You can obtain it from the Team administrator or by looking in the file <code>~/.simpleiot/{team}/config.sys</code> file under the <code>iot_endpoint</code> key. This will typically look something like:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">auq76k34ipflj-ats.iot.us-west-2.amazonaws.com&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For every <strong>Team</strong> installation, this will be different. The certificates generated for each device will only work with this end-point and can not be shared.</p><p>The certificates are generated automatically when a device is added and downloaded to the local machine. The files&#x27; contents can be copy/pasted into String values and passed to the <code>create</code> function.</p><p>A template file called <code>iot-secrets.h</code> is part of the examples with <code>#define</code> expressions. You can paste the values from the generated certificate files, then include the file in your main sketch.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2">Example<a class="hash-link" href="#example-2" title="Direct link to heading">​</a></h4><p>The <code>iot-secrets.h</code> template looks like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * © 2022 Amazon Web Services, Inc. or its affiliates. All Rights Reserved.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * These are AWS IOT credentials. This is for the SimpleIOT demo program.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * Not for production use.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ifndef __SIMPLEIOT_SECRETS__</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define __SIMPLEIOT_SECRETS__</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;pgmspace.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Not really a secret, but all project-dependent values can be defined here.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define SIMPLEIOT_IOT_ENDPOINT &quot;{{ iot_endpoint }}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Root CA file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">static const char SIMPLE_IOT_ROOT_CA[] PROGMEM = R&quot;EOF(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{{ simpleiot_root_ca }}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)EOF&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Device Certificate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">static const char SIMPLE_IOT_DEVICE_CERT[] PROGMEM = R&quot;KEY(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{{ simpleiot_device_cert }}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)KEY&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Device Private Key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">static const char SIMPLE_IOT_DEVICE_PRIVATE_KEY[] PROGMEM = R&quot;KEY(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{{ simpleiot_device_private_key }}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)KEY&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#endif /* __SIMPLEIOT_SECRETS__ */</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can copy-paste the IOT endpoint, Root Certificate, Device Certificate, and Private key values in place of the elements marked in between the <code>{{</code> <code>}}</code> brackets.</p><p>For <code>wifi-settings.h</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * © 2022 Amazon Web Services, Inc. or its affiliates. All Rights Reserved.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * Update these with your own WiFi credentials</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ifndef __SIMPLEIOT_WIFI_SETTINGS__</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define __SIMPLEIOT_WIFI_SETTINGS__</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const char WIFI_SSID[]=&quot;{{ wifi_ssid }}&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const char WIFI_PASSWORD[]=&quot;{{ wifi_password }}&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#endif /* __SIMPLEIOT_WIFI_SETTINGS__ */</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can insert your own Wifi SSID and Password in place of the fields surrounded by <code>{{</code> and <code>}}</code> brackets.</p><p>Inside your Arduino sketch file, you can now include and set the following values near the top of the file, where global settings are placed.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &quot;iot-secrets.h&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &quot;wifi-settings.h&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;SimpleIOT.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define IOT_PROJECT &quot;{my-project}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define IOT_MODEL   &quot;{my-model}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define IOT_SERIAL  &quot;{my-device-serial}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define IOT_FW_VERSION &quot;{firmware-version}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see, the <code>#include</code> directives import the values from inside the <code>.h</code> files. By using <code>#define</code> C/C++ directives, you can make the code more readable and modular.</p><p>By now, you have used all the data items assembled above. Next, let us look at the part where we connect to the cloud and initialize SimpleIOT.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SimpleIOT* iot = NULL; // global instance</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void setup() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">... // other initializations</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  iot = SimpleIOT::create(WIFI_SSID, WIFI_PASSWORD, SIMPLEIOT_IOT_ENDPOINT, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          SIMPLE_IOT_ROOT_CA, SIMPLE_IOT_DEVICE_CERT, SIMPLE_IOT_DEVICE_PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="config">config<a class="hash-link" href="#config" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">void config(const char* project,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            const char* model,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            const char* serialNumber,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            const char* fwVersion = &quot;1.0.0&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            SimpleIOTReadyCallback onReady = NULL,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            SimpleIOTDataCallback onData = NULL,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            SimpleIOTTriggerUpdateCallback onTriggerUpdate = NULL,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            SimpleIOTDiagCallback onDiag = NULL);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>config</code> method is used to configure the values for the device&#x27;s current state and configure callbacks invoked when the firmware needs to be notified of external events.</p><p>In most cases, the <a href="#create">create</a> and <code>config</code> method are called one after the other. But there may be times that specific settings need to be configured before the <code>config</code> command is called, so they are kept separate.</p><p>The parameters passed down are related to the current SimpleIOT project. For a production run, it is assumed that the device will have a place (such as a secure TPM or an EEPROM) where the individual serial numbers are stored. If so, those should be retrieved and passed to the <code>config</code> call.</p><p>The firmware version also needs to be obtained and passed on. Then, the version can be checked against the latest version available on the cloud. This could be hard-coded into the firmware or obtained from an external source.</p><p>The <code>config</code> command initializes the asynchronous remote connection calls. The <a href="#simpleiotreadycallback">onReady</a> function will be invoked when the connection setup has concluded.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-6">Parameters<a class="hash-link" href="#parameters-6" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Definition</th></tr></thead><tbody><tr><td><code>project</code></td><td><code>String*</code></td><td>SimpleIOT Project name</td></tr><tr><td><code>model</code></td><td><code>String</code></td><td>SimpleIOT Model name</td></tr><tr><td><code>serialNumber</code></td><td><code>String</code></td><td>SimpleIOT Device serial number</td></tr><tr><td><code>fwVersion</code></td><td><code>String</code></td><td>Current firmware version in SemVer format</td></tr><tr><td><code>certPem</code></td><td><code>String</code></td><td>Device Certificate text in PEM format</td></tr><tr><td><code>onReady</code></td><td><a href="#simpleiotreadycallback">SimpleIOTReadyCallback</a></td><td>Connection callback handler</td></tr><tr><td><code>onData</code></td><td><a href="#simpleiotdatacallback">SimpleIOTDataCallback</a></td><td>Cloud data callback handler</td></tr><tr><td><code>onTriggerUpdate</code></td><td><a href="#simpleiottriggerupdatecallback">SimpleIOTTriggerUpdateCallback</a></td><td>Cloud data callback handler</td></tr><tr><td><code>onDiag</code></td><td><a href="#simpleiotdiagcallback">SimpleIOTDiagCallback</a></td><td>Diagnostic command callback handler</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3">Example<a class="hash-link" href="#example-3" title="Direct link to heading">​</a></h4><p>With the <code>iot-secrets.h</code> and <code>wifi-settings.h</code> file contents (shown above):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SimpleIOT* iot = NULL; // global instance</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void setup() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  iot-&gt;config(IOT_PROJECT, IOT_MODEL, IOT_SERIAL, IOT_FW_VERSION, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              onConnectionReady, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              onDataFromCloud);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="set">set<a class="hash-link" href="#set" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">int set(const char* name, const char* value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int set(const char* name, int value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int set(const char* name, float value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int set(const char* name, double value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int set(const char* name, bool value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int set(const char* name, const char* value, float latitude, float longitude);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int set(const char* name, int value, float latitude, float longitude);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int set(const char* name, float value, float latitude, float longitude);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int set(const char* name, double value, float latitude, float longitude);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int set(const char* name, bool value, float latitude, float longitude);    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>set</code> family of methods allows sending data to the cloud by providing a name and a value. There are two classes of methods.</p><ol><li>Without GPS data</li><li>With GPS data</li></ol><p>If the device has access to location data, you can send <code>latitude</code> and <code>longitude</code> values along with each telemetry setting. This will be sent to the back-end, and if the system is configured with a tracker through <a href="https://aws.amazon.com/location/" target="_blank" rel="noopener noreferrer">Amazon Location Service</a>, the data will also be sent there to enable GIS/mapping functionality.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>All values sent to the cloud are coerced into string format for uniform handling. The values are ignored if the provided <code>name</code> values are not defined as a <code>Datatype</code>.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-7">Parameters<a class="hash-link" href="#parameters-7" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Definition</th></tr></thead><tbody><tr><td><code>name</code></td><td><code>String*</code></td><td>Name of attribute to send to the cloud</td></tr><tr><td><code>value</code></td><td><code>variant</code></td><td>Value of attribute</td></tr><tr><td><code>latitude</code></td><td><code>float</code></td><td>GPS latitude of observed value</td></tr><tr><td><code>longitude</code></td><td><code>float</code></td><td>GPS longitude of observed value</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-4">Example<a class="hash-link" href="#example-4" title="Direct link to heading">​</a></h4><p>An instance of SimpleIOT should have been created via the <a href="#create">create</a> call and initialized via the <a href="#config">config</a> call. </p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>The callback handler <a href="#simpleiotreadycallback">onReady</a> should have been received successfully before these methods should be called.</p></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">int button;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">float pressure;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bool light_on = false;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // retrieve values and sensor data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   iot-&gt;set(&quot;button&quot;, button);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   iot-&gt;set(&quot;pressure&quot;, pressure);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   iot-&gt;set(&quot;light&quot;, light_on);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If GPS values are available:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bool satellite_valid;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">float pressure;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">float last_lat;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">float last_lng;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  satellite_valid = gps.location.isValid();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  if (satellite_valid) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    last_lat = gps.location.lat();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    last_lng = gps.location.lng();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    iot-&gt;set(&quot;pressure&quot;, pressure, last_lat, last_lng);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loop">loop<a class="hash-link" href="#loop" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    void loop(float delayMs=200);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To give the networking layer time to operate, the sketch has to call the <code>iot-&gt;loop()</code> method periodically inside its own <code>loop</code> method. </p><p>The <code>delayMs</code> parameter indicates how much time to delay and yield before returning to the main sketch. The longer the duration, the more time is given to send the data. The duration should be set based on how often the sensors should be checked. Internally, the Arduino <a href="https://www.arduino.cc/reference/en/language/functions/time/delay/" target="_blank" rel="noopener noreferrer">delay()</a> method is called.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-8">Parameters<a class="hash-link" href="#parameters-8" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Definition</th></tr></thead><tbody><tr><td><code>delayMs</code></td><td><code>int</code></td><td>Number of millliseconds to pass to the <code>delay()</code> function.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-5">Example<a class="hash-link" href="#example-5" title="Direct link to heading">​</a></h4><p>The <code>iot-&gt;loop</code> method should be called inside the Arduino <code>loop</code> function:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">void loop() </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Retrieve sensor data or detect user input</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  iot-&gt;send(&quot;temperature&quot;, temperature);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // This needs to be called to let SimpleIOT and MQTT send and receive data. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // The delay is how many milliseconds you want to wait between each call. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // A smaller number will yield more accurate delta values, but could overload the I2C bus.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  //</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  iot-&gt;loop(200);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="wifi">wifi<a class="hash-link" href="#wifi" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  WiFiClientSecure* wifi = iot-&gt;wifi();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This function provides access to the underlying <a href="https://github.com/espressif/arduino-esp32/tree/master/libraries/WiFiClientSecure" target="_blank" rel="noopener noreferrer">WiFiClientSecure</a> object. You can use this to obtain information about the underlying connection.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="performota">performOTA<a class="hash-link" href="#performota" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">void performOTA(const char* url, SimpleIOTOTACallback otaCallback = NULL);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This method can be invoked with the URL of the remote firmware update. The URL is sent in the
<a href="#simpleiottriggerupdatecallback">SimpleIOTTriggerUpdateCallback</a> callback. The method is specific to the ESP-32 system since it internally uses the <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/ota.html" target="_blank" rel="noopener noreferrer">Espressif Over The Air Updates (OTA)</a> mechanism.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="checkforupdate">checkForUpdate<a class="hash-link" href="#checkforupdate" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">void checkForUpdate(bool force = false);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/simpleiot-build/docs/documentation/sdk/arduino/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/simpleiot-build/docs/documentation/data/intro"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Introduction</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#enums" class="table-of-contents__link toc-highlight">Enums</a><ul><li><a href="#simpleiotmessagetype" class="table-of-contents__link toc-highlight">SimpleIOTMessageType</a></li><li><a href="#simpleiotupdatetype" class="table-of-contents__link toc-highlight">SimpleIOTUpdateType</a></li><li><a href="#simpleiottype" class="table-of-contents__link toc-highlight">SimpleIOTType</a></li></ul></li><li><a href="#callback-handlers" class="table-of-contents__link toc-highlight">Callback Handlers</a><ul><li><a href="#simpleiotreadycallback" class="table-of-contents__link toc-highlight">SimpleIOTReadyCallback</a></li><li><a href="#simpleiotdatacallback" class="table-of-contents__link toc-highlight">SimpleIOTDataCallback</a></li><li><a href="#simpleiottriggerupdatecallback" class="table-of-contents__link toc-highlight">SimpleIOTTriggerUpdateCallback</a></li><li><a href="#simpleiototacallback" class="table-of-contents__link toc-highlight">SimpleIOTOTACallback</a></li><li><a href="#simpleiotdiagcallback" class="table-of-contents__link toc-highlight">SimpleIOTDiagCallback</a></li></ul></li><li><a href="#methods" class="table-of-contents__link toc-highlight">Methods</a><ul><li><a href="#create" class="table-of-contents__link toc-highlight">create</a></li><li><a href="#config" class="table-of-contents__link toc-highlight">config</a></li><li><a href="#set" class="table-of-contents__link toc-highlight">set</a></li><li><a href="#loop" class="table-of-contents__link toc-highlight">loop</a></li><li><a href="#wifi" class="table-of-contents__link toc-highlight">wifi</a></li><li><a href="#performota" class="table-of-contents__link toc-highlight">performOTA</a></li><li><a href="#checkforupdate" class="table-of-contents__link toc-highlight">checkForUpdate</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/simpleiot-build/docs/intro">Welcome</a></li><li class="footer__item"><a class="footer__link-item" href="/simpleiot-build/docs/workshops/intro">Workshops</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/awslabs/simpleiot" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Amazon Web Services, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
<script src="/simpleiot-build/assets/js/runtime~main.b3b197bd.js"></script>
<script src="/simpleiot-build/assets/js/main.cbdba4a3.js"></script>
</body>
</html>