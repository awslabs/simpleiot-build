<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-documentation/data/flow">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<title data-rh="true">Data Flow | SimpleIOT</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://simpleiot.net/docs/documentation/data/flow"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Data Flow | SimpleIOT"><meta data-rh="true" name="description" content="Architecture"><meta data-rh="true" property="og:description" content="Architecture"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://simpleiot.net/docs/documentation/data/flow"><link data-rh="true" rel="alternate" href="https://simpleiot.net/docs/documentation/data/flow" hreflang="en"><link data-rh="true" rel="alternate" href="https://simpleiot.net/docs/documentation/data/flow" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2565bf47.css">
<link rel="preload" href="/assets/js/runtime~main.a892ae96.js" as="script">
<link rel="preload" href="/assets/js/main.a89a2cd9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#18191B;color:#9969F7" role="banner"><div class="announcementBarContent_xLdY">Welcome Starter Bundle users! <a href="/docs/workshops/intro">Click here</a> to go to the Workshop.</div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="SimpleIOT logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="SimpleIOT logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SimpleIOT</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Get Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/documentation/intro">Documentation</a><a class="navbar__item navbar__link" href="/docs/workshops">Workshops</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/team">Team</a><a class="navbar__item navbar__link" href="/docs/github">Github</a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Welcome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/concepts">Basic Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/install/intro">Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/workshops/intro">Workshops</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/documentation/intro">Documentation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/documentation/cli/intro">CLI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/documentation/sdk/intro">Client SDKs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/documentation/data/intro">Data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/data/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/documentation/data/flow">Data Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/data/common">Common Interfaces and APIs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/data/events">Data vs. Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/data/twin">Digital Twins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/data/mqtt">MQTT Topics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/data/datalake">Data Lake</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/data/dbaccess">RDS Database Access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/data/preload">DB Preloading</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/contributing">Contributing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/legal">Legal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/roadmap">Roadmap</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Documentation</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Data</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Data Flow</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Data Flow</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="architecture">Architecture<a class="hash-link" href="#architecture" title="Direct link to heading">​</a></h2><p>Each time the <a href="/docs/install/intro">SimpleIOT Installer</a> is run, the following set of services are created and stitched together:</p><div align="center"><img loading="lazy" src="/img/data/architecture.png" width="100%" class="img_ev3q"></div><p>The system is designed to accept data from devices (via <a href="https://mqtt.org/" target="_blank" rel="noopener noreferrer">MQTT</a>) as well as programmatically via REST APIs.</p><p>The default system maintains three different data storage mechanisms:</p><ol><li><a href="https://aws.amazon.com/rds/postgresql/" target="_blank" rel="noopener noreferrer">Amazon RDS/Postgres</a>: A SQL-based database for storing information about Projects, Models, DataTypes, and the last known value of each Data element. It also acts as a repository for the registration of device instances and metadata.</li><li><a href="https://aws.amazon.com/dynamodb" target="_blank" rel="noopener noreferrer">Amazon DynamoDB</a>: A NoSQL database where individual IoT data transactions are stored. You can retrieve every data item sent via MQTT or API into the system.</li><li><a href="https://aws.amazon.com/timestream/" target="_blank" rel="noopener noreferrer">Amazon Timestream</a>: A scalable, serverless time series database.<p></p><div align="center"><img loading="lazy" src="/img/data/dataflow.png" width="70%" class="img_ev3q"></div></li></ol><p>AWS IOT Core has a built-in rule-based system, where incoming MQTT messages can be filtered based on a SQL-like syntax:</p><div align="center"><img loading="lazy" src="/img/data/iot-core-sql.png" width="70%" class="img_ev3q"></div><p>Messages can then be routed to a variety of destinations:</p><div align="center"><img loading="lazy" src="/img/data/iot-target-list.png" width="70%" class="img_ev3q"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-data-pathway">Common Data Pathway<a class="hash-link" href="#common-data-pathway" title="Direct link to heading">​</a></h2><p>In SimpleIOT, all messages are routed to a Lambda function (called <em>iot_dev_api_data</em>). Here, the data is transformed and modified before being sent by the function to the above destinations. Finally, the lambda validates that the data name matches a defined <strong>Datatype</strong> in a <strong>Model</strong> and only allows the data to be saved.</p><p>However, you can add your own IOT Rules and send copies of the payload to other locations.</p><p>This architecture allows REST API calls via API Gateway to the same Lambda function. This way, REST API calls, and MQTT data go through the same code path. This facilitates supporting a <em>Digital Twin</em> for physical data. </p><p>The same API is invoked by the <a href="/docs/documentation/cli/intro">SimpleIOT Command Line Interface (CLI)</a>, allowing command-line interactions with the twin and remote physical devices.</p><p>This way, data may be sent, viewed, or modified, from a variety of sources:</p><div align="center"><img loading="lazy" src="/img/data/source-flow.png" width="90%" class="img_ev3q"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-live-data">Monitoring Live Data<a class="hash-link" href="#monitoring-live-data" title="Direct link to heading">​</a></h2><p>Whenever this lambda receives a data element, if the Datatype element is marked so it should be shown on a Digital Twin, an MQTT message is broadcast on a pre-defined &#x27;monitor&#x27; MQTT topic. This is useful for monitoring traffic on the system during development and is used by the <a href="/docs/documentation/cli/device#iot-device-monitor">iot data monitor</a> to display the state change of a single data element on a device.</p><p>All data changes (whether MQTT or REST) go through the same lambda function. This lambda does the re-publishing of the data change to the monitor topic. This means that any call to REST API calls (i.e., via the CLI) will invoke an MQTT monitor message which will update in real-time.</p><p>You can disable this behavior by modifying an individual <a href="/docs/documentation/cli/datatype">Datatype</a> and setting <code>show_on_twin</code> to <code>false</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-visualization">Data Visualization<a class="hash-link" href="#data-visualization" title="Direct link to heading">​</a></h2><div align="center"><img loading="lazy" src="/img/data/data-visualization.png" width="60%" class="img_ev3q"><p></p></div>Once the data has made it to the cloud side, you can make use of the data in a variety of ways:<p></p><ul><li><a href="https://grafana.com/grafana/" target="_blank" rel="noopener noreferrer">Grafana</a>. Easy way to build a graphic dashboard. You can take advantage of the fully-managed version with a built-in Timestream connector: <a href="https://aws.amazon.com/grafana" target="_blank" rel="noopener noreferrer">Amazon Managed Grafana</a> - <a href="https://docs.aws.amazon.com/timestream/latest/developerguide/Grafana.html" target="_blank" rel="noopener noreferrer">[Timestream instructions]</a></li><li><a href="https://docs.aws.amazon.com/timestream/latest/developerguide/Quicksight.html" target="_blank" rel="noopener noreferrer">Amazon QuickSight</a>: Serverless BI platform - <a href="https://docs.aws.amazon.com/timestream/latest/developerguide/Quicksight.html" target="_blank" rel="noopener noreferrer">[Timestream instructions]</a></li><li><a href="https://aws.amazon.com/pm/sagemaker/" target="_blank" rel="noopener noreferrer">Amazon SageMaker</a>: fully-managed AI/ML platform - <a href="https://docs.aws.amazon.com/timestream/latest/developerguide/Sagemaker.html" target="_blank" rel="noopener noreferrer">[Timestream instructions]</a></li></ul><p>As mentioned above, you can also route all IoT traffic to other services or trigger events via IoT Core rules:</p><ul><li><a href="https://docs.aws.amazon.com/iotanalytics/latest/userguide/data-visualization.html" target="_blank" rel="noopener noreferrer">AWS IoT Analytics</a>: managed IoT analytics platform - <a href="https://docs.aws.amazon.com/iotanalytics/latest/userguide/quickstart.html" target="_blank" rel="noopener noreferrer">[Instructions]</a></li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>Only MQTT data routed through IoT Core will be sent to other destinations. However, if you want to send both MQTT and REST data, you can modify the <em>iot_dev_api_data</em> lambda function and redirect the data from there.</p></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/documentation/data/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/documentation/data/common"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Common Interfaces and APIs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#architecture" class="table-of-contents__link toc-highlight">Architecture</a></li><li><a href="#common-data-pathway" class="table-of-contents__link toc-highlight">Common Data Pathway</a></li><li><a href="#monitoring-live-data" class="table-of-contents__link toc-highlight">Monitoring Live Data</a></li><li><a href="#data-visualization" class="table-of-contents__link toc-highlight">Data Visualization</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Welcome</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/workshops/intro">Workshops</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/awslabs/simpleiot-build" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website Source<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Amazon Web Services, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a892ae96.js"></script>
<script src="/assets/js/main.a89a2cd9.js"></script>
</body>
</html>